var C={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},H=/([astvzqmhlc])([^astvzqmhlc]*)/gi,N=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function V(o){const s=o.match(N);return s?s.map(Number):[]}function F(o){const s=[],t=String(o).trim();return t[0]!=="M"&&t[0]!=="m"||t.replace(H,(a,n,c)=>{const i=V(c);let h=n.toLowerCase(),l=n;if(h==="m"&&i.length>2&&(s.push([l,...i.splice(0,2)]),h="l",l=l==="m"?"l":"L"),i.length<C[h])return"";for(s.push([l,...i.splice(0,C[h])]);i.length>=C[h]&&i.length&&C[h];)s.push([l,...i.splice(0,C[h])]);return""}),s}function Z(o,s){const t=o.x*Math.cos(s)-o.y*Math.sin(s),a=o.y*Math.cos(s)+o.x*Math.sin(s);o.x=t,o.y=a}function j(o,s,t){o.x+=s,o.y+=t}function B(o,s){o.x*=s,o.y*=s}var $=class L{constructor(s){this.commands=[],s&&s instanceof L?this.commands.push(...s.commands):s&&(this.commands=F(s))}addPath(s){s&&s instanceof L&&this.commands.push(...s.commands)}moveTo(s,t){this.commands.push(["M",s,t])}lineTo(s,t){this.commands.push(["L",s,t])}arc(s,t,a,n,c,i){this.commands.push(["AC",s,t,a,n,c,!!i])}arcTo(s,t,a,n,c){this.commands.push(["AT",s,t,a,n,c])}ellipse(s,t,a,n,c,i,h,l){this.commands.push(["E",s,t,a,n,c,i,h,!!l])}closePath(){this.commands.push(["Z"])}bezierCurveTo(s,t,a,n,c,i){this.commands.push(["C",s,t,a,n,c,i])}quadraticCurveTo(s,t,a,n){this.commands.push(["Q",s,t,a,n])}rect(s,t,a,n){this.commands.push(["R",s,t,a,n])}roundRect(s,t,a,n,c){typeof c>"u"?this.commands.push(["RR",s,t,a,n,0]):this.commands.push(["RR",s,t,a,n,c])}};function A(o,s){let t=0,a=0,n,c,i,h,l,r,v,M,E,g,D,Q,P,m,p,q,z,f,b,w,S,T=null,x=null,d=null,y=null,k=null,R=null;o.beginPath();for(let u=0;u<s.length;++u){f=s[u][0],f!=="S"&&f!=="s"&&f!=="C"&&f!=="c"&&(T=null,x=null),f!=="T"&&f!=="t"&&f!=="Q"&&f!=="q"&&(d=null,y=null);let e;switch(f){case"m":case"M":e=s[u],f==="m"?(t+=e[1],a+=e[2]):(t=e[1],a=e[2]),(f==="M"||!k)&&(k={x:t,y:a}),o.moveTo(t,a);break;case"l":e=s[u],t+=e[1],a+=e[2],o.lineTo(t,a);break;case"L":e=s[u],t=e[1],a=e[2],o.lineTo(t,a);break;case"H":e=s[u],t=e[1],o.lineTo(t,a);break;case"h":e=s[u],t+=e[1],o.lineTo(t,a);break;case"V":e=s[u],a=e[1],o.lineTo(t,a);break;case"v":e=s[u],a+=e[1],o.lineTo(t,a);break;case"a":case"A":if(e=s[u],R===null)throw new Error("This should never happen");f==="a"?(t+=e[6],a+=e[7]):(t=e[6],a=e[7]),m=e[1],p=e[2],v=e[3]*Math.PI/180,i=!!e[4],h=!!e[5],l={x:t,y:a},r={x:(R.x-l.x)/2,y:(R.y-l.y)/2},Z(r,-v),M=r.x*r.x/(m*m)+r.y*r.y/(p*p),M>1&&(M=Math.sqrt(M),m*=M,p*=M),b={x:m*r.y/p,y:-(p*r.x)/m},E=m*m*p*p,g=m*m*r.y*r.y+p*p*r.x*r.x,h!==i?B(b,Math.sqrt((E-g)/g)||0):B(b,-Math.sqrt((E-g)/g)||0),c=Math.atan2((r.y-b.y)/p,(r.x-b.x)/m),n=Math.atan2(-(r.y+b.y)/p,-(r.x+b.x)/m),Z(b,v),j(b,(l.x+R.x)/2,(l.y+R.y)/2),o.save(),o.translate(b.x,b.y),o.rotate(v),o.scale(m,p),o.arc(0,0,1,c,n,!h),o.restore();break;case"C":e=s[u],T=e[3],x=e[4],t=e[5],a=e[6],o.bezierCurveTo(e[1],e[2],T,x,t,a);break;case"c":e=s[u],o.bezierCurveTo(e[1]+t,e[2]+a,e[3]+t,e[4]+a,e[5]+t,e[6]+a),T=e[3]+t,x=e[4]+a,t+=e[5],a+=e[6];break;case"S":e=s[u],(T===null||x===null)&&(T=t,x=a),o.bezierCurveTo(2*t-T,2*a-x,e[1],e[2],e[3],e[4]),T=e[1],x=e[2],t=e[3],a=e[4];break;case"s":e=s[u],(T===null||x===null)&&(T=t,x=a),o.bezierCurveTo(2*t-T,2*a-x,e[1]+t,e[2]+a,e[3]+t,e[4]+a),T=e[1]+t,x=e[2]+a,t+=e[3],a+=e[4];break;case"Q":e=s[u],d=e[1],y=e[2],t=e[3],a=e[4],o.quadraticCurveTo(d,y,t,a);break;case"q":e=s[u],d=e[1]+t,y=e[2]+a,t+=e[3],a+=e[4],o.quadraticCurveTo(d,y,t,a);break;case"T":e=s[u],(d===null||y===null)&&(d=t,y=a),d=2*t-d,y=2*a-y,t=e[1],a=e[2],o.quadraticCurveTo(d,y,t,a);break;case"t":e=s[u],(d===null||y===null)&&(d=t,y=a),d=2*t-d,y=2*a-y,t+=e[1],a+=e[2],o.quadraticCurveTo(d,y,t,a);break;case"z":case"Z":k&&(t=k.x,a=k.y),k=null,o.closePath();break;case"AC":e=s[u],t=e[1],a=e[2],P=e[3],c=e[4],n=e[5],w=e[6],o.arc(t,a,P,c,n,w);break;case"AT":e=s[u],D=e[1],Q=e[2],t=e[3],a=e[4],P=e[5],o.arcTo(D,Q,t,a,P);break;case"E":e=s[u],t=e[1],a=e[2],m=e[3],p=e[4],v=e[5],c=e[6],n=e[7],w=e[8],o.save(),o.translate(t,a),o.rotate(v),o.scale(m,p),o.arc(0,0,1,c,n,w),o.restore();break;case"R":e=s[u],t=e[1],a=e[2],q=e[3],z=e[4],k={x:t,y:a},o.rect(t,a,q,z);break;case"RR":e=s[u],t=e[1],a=e[2],q=e[3],z=e[4],S=e[5],k={x:t,y:a},o.roundRect(t,a,q,z,S);break;default:throw new Error(`Invalid path command: ${f}`)}R?(R.x=t,R.y=a):R={x:t,y:a}}}function I(o,s,t,a,n=0){if(typeof n=="number"&&(n=[n]),Array.isArray(n)){if(n.length===0||n.length>4)throw new RangeError(`Failed to execute 'roundRect' on '${this.constructor.name}': ${n.length} radii provided. Between one and four radii are necessary.`);n.forEach(v=>{if(v<0)throw new RangeError(`Failed to execute 'roundRect' on '${this.constructor.name}': Radius value ${v} is negative.`)})}else return;if(n.length===1&&n[0]===0){this.rect(o,s,t,a);return}const c=Math.min(t,a)/2,i=Math.min(c,n[0]);let h=i,l=i,r=i;n.length===2&&(h=Math.min(c,n[1]),r=h),n.length===3&&(h=Math.min(c,n[1]),r=h,l=Math.min(c,n[2])),n.length===4&&(h=Math.min(c,n[1]),l=Math.min(c,n[2]),r=Math.min(c,n[3])),this.moveTo(o,s+a-r),this.arcTo(o,s,o+i,s,i),this.arcTo(o+t,s,o+t,s+h,h),this.arcTo(o+t,s+a,o+t-l,s+a,l),this.arcTo(o,s+a,o,s+a-r,r),this.moveTo(o,s)}function G(o){if(!o)return;const s=o.prototype.fill,t=o.prototype.stroke,a=o.prototype.isPointInPath;o.prototype.fill=function(...n){if(n[0]instanceof $){const i=n[0],h=n[1]||"nonzero";return A(this,i.commands),s.apply(this,[h])}const c=n[0]||"nonzero";return s.apply(this,[c])},o.prototype.stroke=function(n){n&&A(this,n.commands),t.apply(this)},o.prototype.isPointInPath=function(...n){if(n[0]instanceof $){const c=n[0],i=n[1],h=n[2],l=n[3]||"nonzero";return A(this,c.commands),a.apply(this,[i,h,l])}return a.apply(this,n)}}function J(o){o&&!o.prototype.roundRect&&(o.prototype.roundRect=I)}function K(o){o&&!o.prototype.roundRect&&(o.prototype.roundRect=I)}export{$ as Path2D,G as applyPath2DToCanvasRenderingContext,J as applyRoundRectToCanvasRenderingContext2D,K as applyRoundRectToPath2D,A as buildPath,F as parsePath,I as roundRect};
